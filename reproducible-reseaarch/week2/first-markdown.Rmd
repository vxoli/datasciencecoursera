---
title: "Reproducible research Week 2 Assgnment"
author: "Christopher Stonell"
date: "2023-09-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Assignment Project 1  
## Loading and preprocessing the data  
```{r read_activity_data, echo=TRUE}
data <- read.csv(("/home/christopher/Documents/Coursera_Data_Science/datasciencecoursera/reproducible-reseaarch/week2/activity.csv"))
# process data
data$steps <- as.numeric((data$steps))
data$date <- as.Date(data$date)
data$interval <- as.numeric((data$interval))
```

## What is mean total number of steps taken per day?
This is the histogram of total steps per day.  

```{r histogram, echo=TRUE}
hist(tapply(data$steps, data$date, sum), main="Histogram of total steps/day", xlab = deparse1(substitute(data$date)))
```

``` {r compute_setps_intervals, echo=TRUE}
## compute interval with max average number of steps
intervalSteps <- aggregate(data$steps, list(data$interval), mean)
maxIntervalSteps <- intervalSteps[intervalSteps['x'] == max(intervalSteps['x']),][1]
maxIntervalSteps
## need to include to text print the variable below.
## this calculation works in console but returns error in markdown - WHY?
```


## Mean and median number of steps per day

```{r mean-and-median-steps-per-day, echp=TRUE}
# remove na and 0 days
meanSteps <- mean(subset(data$steps, !(data$steps == 0), data$steps, na.rm = TRUE))
medianSteps <- median(subset(data$steps, !(data$steps == 0), data$steps, na.rm = TRUE))
```

The mean number of steps per day is: `r meanSteps` steps.  
The median number of steps per day is: `r medianSteps` steps.  

## Average Daily Activity Pattern

```{r daily-acticity-time-series-plot, echo=TRUE}
library(ggplot2)
plotData <- aggregate(data$steps, list(data$interval), mean)
p <- ggplot(plotData, aes(x=`Group.1`, y=`x`)) + geom_line() + xlab("Interval") + ylab("Steps")
p
```

```{r count-NAs, echo=TRUE}
count_NAs <- sum(is.na(data))

```

The total number of NA's in the dataset is: `r count_NAs`  
  
## Impute missing values
For steps and interval
```{r impute, echo=TRUE}
## replace NA in steps with mean of steps for whole sample and put into new dataset
dataWithRelacement <- data
dataWithRelacement$steps[is.na(data$steps)] <- mean(data$steps, na.rm=TRUE)
```

## Histograms with imputed values

```{r more_histograms, echo=TRUE}
hist(tapply(dataWithRelacement$steps, dataWithRelacement$date, sum), main="Histogram of total steps/day (NA replaced by mean)", xlab = deparse1(substitute(dataWithRelacement$date)))
```