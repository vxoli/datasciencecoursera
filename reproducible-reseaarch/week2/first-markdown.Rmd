---
title: "Reproducible research Week 2 Assgnment"
author: "Christopher Stonell"
date: "2023-09-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r read_activity_data, echo=TRUE}
data <- read.csv(("/home/christopher/Documents/Coursera_Data_Science/datasciencecoursera/reproducible-reseaarch/week2/activity.csv"))
# process data
data$steps <- as.numeric((data$steps))
data$date <- as.Date(data$date)
data$interval <- as.numeric((data$interval))
```

## Histogram of steps per day

This is the histogram of steps per day.

```{r histogram, echo=TRUE}
hist(tapply(data$steps, data$date, sum), main="Histogram of total steps/day", xlab = deparse1(substitute(data$date)))
```

## Mean and median number of steps per day

```{r mean-and-median-steps-per-day, echp=TRUE}
meanSteps <- aggregate(data$steps, list(data$date), mean)
medianSteps <- aggregate(data$steps, list(data$date), median)
mean_med <- as.data.frame(append(meanSteps, medianSteps[2]))
names(mean_med) <- c("Date","Mean","Median")
mean_med
```

## Average Daily Activity Pattern

```{r daily-acticity-time-series-plot, echo=TRUE}
library(ggplot2)
ggplot(subset(data, !((is.na(data$steps)) | data$steps == 0)), aes(x = date, y= steps)) + geom_line() + geom_line(data = mean_med, aes(x = Date, y= Mean), color = "red")
```

```{r count-NAs, echo=TRUE}
count_NAs <- sum(is.na(data))

```

The total number of NA's in the dataset is: `r count_NAs`  
  
## Impute missing values
For steps and interval
```{r impute, echo=TRUE}
## replace NA in steps with mean of steps for whole sample and put into new dataset
dataWithRelacement <- data
dataWithRelacement$steps[is.na(data$steps)] <- mean(data$steps, na.rm=TRUE)
```

## Histograms with imputed values

```{r more_histograms, echo=TRUE}
hist(tapply(dataWithRelacement$steps, dataWithRelacement$date, sum), main="Histogram of total steps/day (NA replaced by mean)", xlab = deparse1(substitute(dataWithRelacement$date)))
```